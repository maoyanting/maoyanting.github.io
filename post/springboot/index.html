<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <link href="//gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.57.2" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Spring Boot(æœªå®Œ) &middot; ä¿®ä»™ä¸‹å±å§”å‘˜ä¼š</title>

  
  <link type="text/css" rel="stylesheet" href="https://maoyanting.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://maoyanting.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://maoyanting.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://maoyanting.github.io/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">



  <link href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/monokai.min.css" rel="stylesheet">
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="ä¿®ä»™ä¸‹å±å§”å‘˜ä¼š" />

  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://maoyanting.github.io/"><h1>ä¿®ä»™ä¸‹å±å§”å‘˜ä¼š</h1></a>
      <p class="lead">
      å‰ç»™æ’æ°´å·¥ç¨‹å¸ˆç°ç¨‹åºåª› 
      <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://maoyanting.github.io/">Home</a> </li>
        <li><a href="https://maoyanting.github.io//categories/index.html">Categories</a> </li>
        <li><a href="https://maoyanting.github.io//about/index.html">About Me</a> </li>
        <li><a href="/posts/"> Blog </a></li><li><a href="/categories/"> Categories </a></li><li><a href="/about"> About </a></li>
      </ul>
    </nav>

    <p>&copy; 2020. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>Spring Boot(æœªå®Œ)</h1>
  <div id="toc" class="well col-md-4 col-sm-6">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#springapplicationå¯åŠ¨">SpringApplicationå¯åŠ¨</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
  <time datetime=2019-02-25T22:12:50&#43;0800 class="post-date">Mon, Feb 25, 2019</time>
  <p>è¿™å¹´å¤´æ–°é¡¹ç›®ä¸ç”¨ <code>Spring Boot</code> çš„å¤§æ¦‚æƒ³æ³•æ¯”è¾ƒå¼‚äºå¸¸äººğŸ˜…</p>

<p>ä»£ç åŸºäº <code>Spring Boot 2.0</code></p>

<h3 id="springapplicationå¯åŠ¨">SpringApplicationå¯åŠ¨</h3>

<p>ä¸€èˆ¬ä¸€ä¸ªmodule Spring Boot éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯åŠ¨ç±»ï¼Œç±»ä¼¼äºä¸‹é¢</p>

<pre><code class="language-java">@SpringBootApplication
@MapperScan(&quot;com.yuantu.billmanager.mapper&quot;)
public class WebApplication {

    public static void main(String[] args) {
        SpringApplication.run(WebApplication.class, args);
    }
}
</code></pre>

<p>æˆ‘ä»¬é¦–å…ˆè¿›å…¥ <code>SpringApplication.run</code> è¿™é‡Œè°ƒç”¨äº†å¦ä¸€ä¸ª  <code>SpringApplication.run</code></p>

<pre><code class="language-java">public static ConfigurableApplicationContext run(Class&lt;?&gt; primarySource,String... args) {
    return run(new Class&lt;?&gt;[] { primarySource }, args);
}
</code></pre>

<p>ç»§ç»­ä¸‹ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ª <code>run</code> æ–¹æ³•é‡Œé¢æ˜¯å¯ä»¥æ”¾å…¥å¤šä¸ª <code>primarySource</code> çš„ï¼Œå…·ä½“ä½¿ç”¨æƒ…å†µæˆ‘ä»¬ä»¥åå†çœ‹</p>

<p>è¿™é‡Œè°ƒç”¨äº† <code>SpringApplication</code>  çš„æ„é€ å‡½æ•°ï¼Œç„¶ååˆè¿è¡Œ <code>run</code> æ–¹æ³•ï¼ˆå¦ˆè€¶ä½ æ€ä¹ˆè¿˜æ²¡æ‰§è¡ŒğŸ˜°ï¼‰</p>

<pre><code class="language-java">public static ConfigurableApplicationContext run(Class&lt;?&gt;[] primarySources,
			String[] args) {
    return new SpringApplication(primarySources).run(args);
}
</code></pre>

<p>æˆ‘ä»¬å…ˆæ¥çœ‹æ„é€ å‡½æ•°ï¼Œå†å¾€ä¸‹ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¹‹å‰ <code>Spring</code> è®©äººå´©æºƒä¸”è®°ä¸ä½çš„é…ç½®åˆ°åº•æ€ä¹ˆå¤„ç†äº†ã€‚</p>

<pre><code class="language-java">public SpringApplication(Class&lt;?&gt;... primarySources) {
    this(null, primarySources);
}

@SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
public SpringApplication(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources) {
    this.resourceLoader = resourceLoader;
    //æ ¡éªŒ
    Assert.notNull(primarySources, &quot;PrimarySources must not be null&quot;);
    //ä¿å­˜primarySources
    this.primarySources = new LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));
    //åˆ¤æ–­æ˜¯å¦æ˜¯webåº”ç”¨
    this.webApplicationType = deduceWebApplicationType();
    setInitializers((Collection) getSpringFactoriesInstances(
				ApplicationContextInitializer.class));
    //å¯»æ‰¾Listener
    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));
    //æ‰¾åˆ°å«æœ‰mainå‡½æ•°çš„ç±»
    this.mainApplicationClass = deduceMainApplicationClass();
}
</code></pre>

<p>æ„é€ å®Œæ¯•ä»¥åï¼Œæˆ‘ä»¬ç»ˆäºè¦æ‰§è¡Œ <code>run</code> æ–¹æ³•äº†</p>

<pre><code class="language-java">public ConfigurableApplicationContext run(String... args) {
    //Springæä¾›çš„è®¡æ—¶å™¨
    StopWatch stopWatch = new StopWatch();
    stopWatch.start();
    ConfigurableApplicationContext context = null;
    Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = new ArrayList&lt;&gt;();
    //é…ç½®Headlessï¼Œå‘Šè¯‰ç¨‹åºæˆ‘æ²¡æœ‰æ˜¾ç¤ºå™¨ç­‰ç¡¬ä»¶
    configureHeadlessProperty();
    //è·å–Listeners
    SpringApplicationRunListeners listeners = getRunListeners(args);
    listeners.starting();
    try {
        ApplicationArguments applicationArguments = new DefaultApplicationArguments(
            args);
        //å‡†å¤‡ç¯å¢ƒ
        ConfigurableEnvironment environment = prepareEnvironment(listeners,
            applicationArguments);
        //é…ç½®ignoreï¼Œé»˜è®¤ä¸ºtrueï¼Œä¸æ‰«æBeanInfoç±»
        configureIgnoreBeanInfo(environment);
        //ç»˜åˆ¶Bannerï¼Œè¿™é‡Œå¯ä»¥è‡ªå·±ç”Ÿæˆä¸€ä¸ªBanner.txtæ–‡ä»¶æ¥ä»£æ›¿
        Banner printedBanner = printBanner(environment);
        //ç”Ÿæˆä¸Šä¸‹æ–‡å®¹å™¨
        context = createApplicationContext();
        exceptionReporters = getSpringFactoriesInstances(
            SpringBootExceptionReporter.class,
            new Class[] { ConfigurableApplicationContext.class }, context);
        prepareContext(context, environment, listeners, applicationArguments,
	            printedBanner);
        //åˆ·æ–°å®¹å™¨
        refreshContext(context);
        //é‡Œé¢æ˜¯ç©ºçš„â€¦â€¦ç©ºçš„â€¦â€¦å¤§æ¦‚å¯ä»¥ç”¨æ¥å®ç°ä¸€äº›ç‰¹æ®Šéœ€æ±‚
        afterRefresh(context, applicationArguments);
        //åœæ­¢è®¡æ—¶å™¨
        stopWatch.stop();
        if (this.logStartupInfo) {
            new StartupInfoLogger(this.mainApplicationClass)
                .logStarted(getApplicationLog(), stopWatch);
        }
        listeners.started(context);
        //è¿™é‡ŒæŸ¥æ‰¾å®ç°äº†ApplicationRunnerå’ŒCommandLineRunnerçš„ç±»ï¼Œå¯ä»¥å†è¿™ä¸¤ä¸ªç±»é‡Œé¢åŠ å¸Œæœ›Springåˆå§‹åŒ–ä»¥åæ‰§è¡Œçš„å†…å®¹ï¼ŒSpringMVCçš„è¯ä¸€èˆ¬ä½¿ç”¨Listeneræ¥å®ç°ã€‚
        callRunners(context, applicationArguments);
        }catch (Throwable ex) {
            handleRunFailure(context, listeners, exceptionReporters, ex);
            throw new IllegalStateException(ex);
        }
        listeners.running(context);
        return context;
    }
</code></pre>
</div>


<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </main>

    
  </body>
</html>
